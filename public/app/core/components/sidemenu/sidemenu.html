<ul class="sidemenu sidemenu-main">

    <li class="sidemenu-org-section dropdown" ng-if="ctrl.isSignedIn">
        <div class="sidemenu-org" data-toggle="dropdown" ng-click="ctrl.openUserDropdown()">
            <div class="sidemenu-org-avatar">
                <img ng-src="{{ctrl.user.gravatarUrl}}">
            </div>
            <div class="sidemenu-org-details">
                <span class="sidemenu-org-user sidemenu-item-text">{{ctrl.user.name}}</span>
                <span class="sidemenu-org-name sidemenu-item-text">{{ctrl.user.orgName}}</span>
            </div>
            <i class="fa fa-caret-right small"></i>
        </div>
        <ul class="dropdown-menu" role="menu">
            <li ng-repeat="menuItem in ctrl.orgMenu" ng-class="menuItem.cssClass">
                <span ng-if="menuItem.section">{{menuItem.section}}</span>
                <a href="{{menuItem.url}}" ng-if="menuItem.url" target="{{menuItem.target}}">
                    <i class="{{menuItem.icon}}" ng-if="menuItem.icon"></i>
                    {{menuItem.text}}
                </a>
                <a ng-click="menuItem.click()" ng-if="menuItem.click">
                    <i class="{{menuItem.icon}}"></i>
                    {{menuItem.text}}
                </a>
            </li>
        </ul>
    </li>

    [[if .User.IsGrafanaAdmin]]
    <li class="sidemenu-system-section" ng-if="ctrl.systemSection">
        <div class="sidemenu-system-section-inner">
            <i class="fa fa-fw fa-cubes"></i>
            <div class="sidemenu-section-text-wrapper">
                <div class="sidemenu-section-heading">Grafana Admin</div>
                <div class="sidemenu-section-tagline">v {{ctrl.grafanaVersion}}</div>
            </div>
        </div>
    </li>
    [[end]]

    [[if .User.IsGrafanaAdmin]]
    <li ng-repeat="item in ctrl.mainLinks">
        <a href="{{item.url}}" class="sidemenu-item sidemenu-main-link" target="{{item.target}}">
			<span class="icon-circle sidemenu-icon">
				<i class="{{item.icon}}" ng-show="item.icon"></i>
				<img ng-src="{{item.img}}" ng-show="item.img">
			</span>
            <span class="sidemenu-item-text">{{item.text}}</span>
        </a>
    </li>
    [[end]]

    [[if .User.IsGrafanaAdmin]]
    <ul class="sidemenu sidemenu-small" style="margin-top:50px" ng-if="ctrl.systemSection">
        <li>
            <a href="{{ctrl.appSubUrl}}/" class="sidemenu-item">
                <span class="icon-circle sidemenu-icon"><i class="fa fa-fw fa-backward"></i></span>
                <span class="sidemenu-item-text">Exit admin</span>
            </a>
        </li>
    </ul>
    [[end]]

    <li ng-if="!ctrl.isSignedIn">
        <a href="login" class="sidemenu-item" target="_self">
            <span class="icon-circle sidemenu-icon"><i class="fa fa-fw fa-sign-in"></i></span>
            <span class="sidemenu-item-text">Sign in</span>
        </a>
    </li>

    <div ng-controller="SearchCtrl" ng-init="init()" class="search-box">

        <div class="search-field-wrapper">
		<span style="position: relative;">
			<input  type="text" placeholder="Find dashboards by name" give-focus="giveSearchFocus" tabindex="1"
                    ng-keydown="keyDown($event)" ng-model="query.query" ng-model-options="{ debounce: 500 }" spellcheck='false' ng-change="search()" />
		</span>
            <div class="search-switches">
                <i class="fa fa-filter"></i>
                <a class="pointer" href="javascript:void 0;" ng-click="showStarred()" tabindex="2">
                    <i class="fa fa-remove" ng-show="query.starred"></i>
                    starred
                </a> |
                <a class="pointer" href="javascript:void 0;" ng-click="getTags()" tabindex="3">
                    <i class="fa fa-remove" ng-show="tagsMode"></i>
                    tags
                </a>
			<span ng-if="query.tag.length">
				|
				<span ng-repeat="tagName in query.tag">
					<a ng-click="removeTag(tagName, $event)" tag-color-from-name="tagName" class="label label-tag">
                        <i class="fa fa-remove"></i>
                        {{tagName}}
                    </a>
				</span>
			</span>
            </div>
        </div>

        <div class="search-results-container" ng-if="tagsMode">
            <div class="row">
                <div class="span6 offset1">
                    <div ng-repeat="tag in results" class="pointer" style="width: 180px; float: left;"
                         ng-class="{'selected': $index === selectedIndex }"
                         ng-click="filterByTag(tag.term, $event)">
                        <a class="search-result-tag label label-tag" tag-color-from-name="tag.term">
                            <i class="fa fa-tag"></i>
                            <span>{{tag.term}} &nbsp;({{tag.count}})</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <div class="search-results-container" ng-if="!tagsMode">
            <h6 ng-hide="results.length">No dashboards matching your query were found.</h6>

            <a class="search-item pointer search-item-{{row.type}}" bindonce ng-repeat="row in results"
               ng-class="{'selected': $index == selectedIndex}" ng-href="{{row.url}}">

			<span class="search-result-tags">
				<span ng-click="filterByTag(tag, $event)" ng-repeat="tag in row.tags" tag-color-from-name="tag"  class="label label-tag">
					{{tag}}
				</span>
				<i class="fa" ng-class="{'fa-star': row.isStarred, 'fa-star-o': !row.isStarred}"></i>
			</span>

			<span class="search-result-link">
				<i class="fa search-result-icon"></i>
				<span bo-text="row.title"></span>
			</span>
            </a>
        </div>

        <div class="search-button-row">
            <button class="btn btn-inverse pull-left" ng-click="newDashboard()" ng-show="contextSrv.isEditor">
                <i class="fa fa-plus"></i>
                New
            </button>
            <a class="btn btn-inverse pull-left" href="import/dashboard" ng-show="contextSrv.isEditor">
                <i class="fa fa-download"></i>
                Import
            </a>
            <div class="clearfix"></div>
        </div>

    </div>

</ul>